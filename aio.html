<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Introduction to HPC and SLURM: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="assets/styles.css">
<script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="manifest" href="site.webmanifest">
<link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="white">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="black">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md top-nav incubator"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="incubator-logo" alt="Carpentries Incubator" src="assets/images/incubator-logo.svg">
</div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
<li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul>
</li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/aio.html';">Instructor View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Carpentries Incubator" src="assets/images/incubator-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      Introduction to HPC and SLURM
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Introduction to HPC and SLURM
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<li><a class="dropdown-item" href="reference.html">Summary</a></li>
          </ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Introduction to HPC and SLURM
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text">
<li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul>
</li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/aio.html">Instructor View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->

            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-introduction.html">1. What is a HPC?</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02-milton.html">2. Accessing Milton</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="03-modules.html">3. Environment Modules</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="04-break.html">4. Lunch Break</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="05-slurm.html">5. Introducing Slurm</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="06-submit.html">6. Submitting a Job</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="07-evaluate.html">7. Evaluating Jobs</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="08-break.html">8. Break</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="09-commands.html">9. Slurm Commands</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush11">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading11">
        <a href="10-interactive.html">10. Interactive Slurm Jobs</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="reference.html">Summary</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources">
<a href="aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">

            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-01-introduction"><p>Content from <a href="01-introduction.html">What is a HPC?</a></p>
<hr>
<p>Last updated on 2023-05-16 |

        <a href="https://github.com/WEHI-ResearchComputing/Workshop-IntroToHPC-Slurm/edit/main/episodes/01-introduction.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Why would I be interested in High Performance Computing (HPC)?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe what an HPC system is</li>
<li>Identify how an HPC system could benefit you.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>Open the <a href="https://wehieduau.sharepoint.com/:p:/s/rc2/EVLoeAXqz7hFuqDM59COiYkBiGvnkY-Lgh8C9pOTSeJSsA?e=BdafRQ" class="external-link">Introduction
Slides</a> in a new tab for an introduction to the course and Research
Computing.</p>
</section><section><h2 class="section-heading" id="defining-common-terms">Defining common terms<a class="anchor" aria-label="anchor" href="#defining-common-terms"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="what-is-cluster-computing">What is cluster computing?<a class="anchor" aria-label="anchor" href="#what-is-cluster-computing"></a>
</h3>
<p>Cluster computing refers to two or more computers that are networked
together to provide solutions as required.</p>
<p>A cluster of computers joins computational powers of the individual
computers (called “compute nodes”) to provide a more combined
computational power.</p>
<figure><img src="fig/cluster.png" alt="Cluster Computing by Trevor Dsouza from Noun Project" class="figure mx-auto d-block"><div class="figcaption">Cluster Computing by Trevor Dsouza from
<a href="https://thenounproject.com/browse/icons/term/cluster-computing/" target="_blank" title="Cluster Computing Icons" class="external-link">Noun
Project</a>
</div>
</figure>
</div>
<div class="section level3">
<h3 id="what-is-a-hpc-cluster">What is a HPC cluster?<a class="anchor" aria-label="anchor" href="#what-is-a-hpc-cluster"></a>
</h3>
<p>HPC stands for High Performance Computing, which is the ability to
process data and perform complex calculations at high speeds.</p>
<p>In its simplest structure, HPC clusters are intended to utilize
parallel processors to apply more computing force to solve a problem.
HPC clusters are a kind of compute clusters that typically have a large
number of compute nodes, which share a file system designed for parallel
reading and writing, and use a high-speed network for communication with
each other.</p>
</div>
<div class="section level3">
<h3 id="what-is-a-supercomputer">What is a supercomputer?<a class="anchor" aria-label="anchor" href="#what-is-a-supercomputer"></a>
</h3>
<p>Supercomputer used to refer to any single computer system that has
exceptional processing power for its time. But recently, it refers to
the best-known types of HPC solutions. A supercomputer contains
thousands of compute nodes that work together to complete one or more
tasks in parallel.</p>
<div id="callout1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout</h3>
<div class="callout-content">
<p><code>supercomputers</code> and
<code>high-performance computers</code> are often used
interchangeably.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="how-is-supercomputing-performance-measured">How is supercomputing performance measured?<a class="anchor" aria-label="anchor" href="#how-is-supercomputing-performance-measured"></a>
</h3>
<p>The most popular benchmark is the <a href="https://www.top500.org/project/linpack/" class="external-link">LINPACK benchmark</a>
which is used for the <a href="https://www.top500.org/lists/top500" class="external-link">TOP500</a>. The LINPACK
benchmark reflect the performance of a dedicated system for solving a
dense system of linear equations. It uses the number of floating point
operations per second (FLOPS) as the metric. The <a href="https://www.top500.org/lists/green500/" class="external-link">GREEN500</a> ranking has
also risen in popularity as it ranks HPC systems based on FLOPS per Watt
of power (higher the better).</p>
</div>
</section><section><h2 class="section-heading" id="when-to-use-a-hpc-cluster">When to use a HPC cluster?<a class="anchor" aria-label="anchor" href="#when-to-use-a-hpc-cluster"></a>
</h2>
<hr class="half-width">
<p>Frequently, research problems that use computing can outgrow the
capabilities of the desktop or laptop computer where they started, such
as the following examples</p>
<blockquote>
<ul>
<li>A statistics student wants to cross-validate a model. This involves
running the model 1000 times – but each run takes an hour. Running the
model on a laptop will take over a month! In this research problem,
final results are calculated after all 1000 models have run, but
typically only one model is run at a time (in <strong>serial</strong>)
on the laptop. Since each of the 1000 runs is independent of all others,
and given enough computers, it’s theoretically possible to run them all
at once (in <strong>parallel</strong>).</li>
<li>A genomics researcher has been using small datasets of sequence
data, but soon will be receiving a new type of sequencing data that is
10 times as large. It’s already challenging to open the datasets on a
computer – analyzing these larger datasets will probably crash it. In
this research problem, the calculations required might be impossible to
parallelize, but a computer with <strong>more memory</strong> would be
required to analyze the much larger future data set.</li>
</ul>
</blockquote>
<p>In these cases, access to <strong>more</strong> (and
<strong>larger</strong>) computers is needed. Those computers should be
usable at the same time, <strong>solving many researchers’ problems in
parallel</strong>.</p>
<p>Therefore, HPCs are userful when you have:</p>
<ul>
<li>A program that can be recompiled or reconfigured to use optimized
numerical libraries that are available on HPC systems but not on your
own system;</li>
<li>You have a parallel problem, e.g. you have a single application that
needs to be rerun many times with different parameters;</li>
<li>You have an application that has already been designed with
parallelism;</li>
<li>To make use of the large memory available;</li>
<li>When solutions require backups for future use. HPC facilities are
reliable and regularly backed up.</li>
</ul></section><section><h2 class="section-heading" id="how-to-interact-with-hpc-clusters">How to interact with HPC clusters?<a class="anchor" aria-label="anchor" href="#how-to-interact-with-hpc-clusters"></a>
</h2>
<hr class="half-width">
<p>Researchers usually interact with HPC clusters by connecting remotely
to the HPC cluster via the Linux command line. This is because of its
low cost and setup as well as most research HPC software being written
for the Linux command line. Microsoft Windows HPC facilities exist, but
usually serve specific niches like corporate finance.</p>
<p>However, graphical interfaces have become popular and have helped
lower the barrier to learning how to use HPC. <a href="https://openondemand.org/" class="external-link">Open OnDemand</a> being the most
popular example of software that helps users interact with HPC
graphically.</p>
</section><section><h2 class="section-heading" id="what-is-milton">What is Milton?<a class="anchor" aria-label="anchor" href="#what-is-milton"></a>
</h2>
<hr class="half-width">
<figure><img src="fig/milton.png" class="figure mx-auto d-block"></figure><p>In 2016, WEHI purchased an on-premise HPC cluster called Milton,
Milton includes &gt;4500-cores (2 hyperthreads per core), &gt;60TB
memory, ~ 58 GPUs, &gt;10 petabytes of tiered-storage. All details are
available <a href="https://wehieduau.sharepoint.com/sites/rc2/SitePages/Milton-hardware.aspx" class="external-link">here</a>.</p>
<p>Milton contains a mix of Skylake, Broadwell, Icelake and Cooperlake
Intel processors.</p>
<figure><img src="fig/miltonschematic.png" class="figure mx-auto d-block"></figure><div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Using High Performance Computing (HPC) typically involves connecting
to very large computing systems that provides a high computational
power.</li>
<li>These systems can be used to do work that would either be impossible
or much slower on smaller systems.</li>
<li>HPC resources are shared by multiple users.</li>
<li>The resources found on independent compute nodes can vary in volume
and type (amount of RAM, processor architecture, availability of shared
filesystems, etc.).</li>
<li>The standard method of interacting with HPC systems is via a command
line interface.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-02-milton"><p>Content from <a href="02-milton.html">Accessing Milton</a></p>
<hr>
<p>Last updated on 2023-05-16 |

        <a href="https://github.com/WEHI-ResearchComputing/Workshop-IntroToHPC-Slurm/edit/main/episodes/02-milton.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I log in to <code>Milton</code>?</li>
<li>Where can I store my data?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Connect to <code>Milton</code>.</li>
<li>Identify where to save your data</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="milton-cluster">Milton Cluster<a class="anchor" aria-label="anchor" href="#milton-cluster"></a>
</h2>
<hr class="half-width">
<p>Milton is a linux-based cluster, that is made up of two login nodes
and many computer nodes in addition to the file systems.</p>
<div class="section level3">
<h3 id="what-is-a-nodes-made-up-of">What is a nodes made up of?<a class="anchor" aria-label="anchor" href="#what-is-a-nodes-made-up-of"></a>
</h3>
<ul>
<li>Physical cores</li>
<li>Memory</li>
<li>Local storage</li>
<li>Maybe GPU(s)</li>
</ul>
<figure><img src="fig/node_anatomy.png" alt="Node diagram" class="figure mx-auto d-block"><div class="figcaption">Node diagram</div>
</figure>
</div>
</section><section><h2 class="section-heading" id="connect-to-milton">Connect to Milton<a class="anchor" aria-label="anchor" href="#connect-to-milton"></a>
</h2>
<hr class="half-width">
<p>The first step in using a cluster is to establish a connection from
your laptop to the cluster. You need a Windows Command Prompt or macOS
Terminal, to connect to a login node and access the command line
interface (CLI).</p>
<div id="exercise-1-can-you-login-to-milton" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-1-can-you-login-to-milton" class="callout-inner">
<h3 class="callout-title">Exercise 1: Can you login to Milton?</h3>
<div class="callout-content">
<p>If not in WEHI, make sure you are on the VPN. While on a WEHI device,
open your terminal and login to vc7-shared.</p>
<p>More details are available <a href="https://wehieduau.sharepoint.com/sites/rc2/SitePages/using-milton.aspx#ssh-(command-line)-sessions-(slurm)" class="external-link">here</a>.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<ul>
<li>For Mac OSX users
<ul>
<li><code>ssh vc7-shared</code></li>
<li>Type your password</li>
</ul>
</li>
<li>For MS-Windows users
<ul>
<li>Download and install the free <a href="https://putty.org" class="external-link">PuTTY
client</a>.</li>
</ul>
</li>
<li>You can also use <a href="https://ondemand.hpc.wehi.edu.au/pun/sys/shell/ssh/slurm-login.hpc.wehi.edu.au" class="external-link">Cluster
Access on Open OnDemand</a>
</li>
</ul>
</div>
</div>
</div>
</div>
<p>You will be asked for your password.</p>
<p><strong>Watch out:</strong> the characters you type after the
password prompt are not displayed on the screen. Normal output will
resume once you press <code>Enter</code>.</p>
<p>You will notice that the prompt changed when you logged into the
remote system using the terminal.</p>
<figure><img src="fig/ssh-vc7.png" alt="Login to vc7-shared" class="figure mx-auto d-block"><div class="figcaption">Login to vc7-shared</div>
</figure></section><section><h2 class="section-heading" id="milton-file-systems">Milton File Systems<a class="anchor" aria-label="anchor" href="#milton-file-systems"></a>
</h2>
<hr class="half-width">
<figure><img src="fig/M_FS.png" alt="Milton File Systems" class="figure mx-auto d-block"><div class="figcaption">Milton File Systems</div>
</figure><figure><img src="fig/FSdetails.png" alt="Managed Versus UnManaged File Systems" class="figure mx-auto d-block"><div class="figcaption">Managed Versus UnManaged File Systems</div>
</figure><div class="section level3">
<h3 id="how-data-should-be-moved-between-file-systems-according-to-project-requirements">How data should be moved between file systems according to project
requirements?<a class="anchor" aria-label="anchor" href="#how-data-should-be-moved-between-file-systems-according-to-project-requirements"></a>
</h3>
<p><br><br></p>
<figure><img src="fig/dataretention.png" alt="Case 1: Data from external collaborators and needs long term retention" class="figure mx-auto d-block"><div class="figcaption">Case 1: Data from external collaborators and
needs long term retention</div>
</figure><p><br><br></p>
<figure><img src="fig/datadelete.png" alt="Case 2: Data from publicly available source, or with delete on-completion constraint" class="figure mx-auto d-block"><div class="figcaption">Case 2: Data from publicly available source, or
with delete on-completion constraint</div>
</figure>
</div>
</section><section><h2 class="section-heading" id="looking-around-your-home">Looking Around Your Home<a class="anchor" aria-label="anchor" href="#looking-around-your-home"></a>
</h2>
<hr class="half-width">
<p>We will now revise some linux commands to look around the login
node.</p>
<div id="exercise-2check-the-name-of-the-current-node" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-2check-the-name-of-the-current-node" class="callout-inner">
<h3 class="callout-title">Exercise 2:Check the name of the current node</h3>
<div class="callout-content">
<p>Get node name where you are logged into</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">$</span> hostname</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">vc7</span><span class="op">-</span><span class="va">shared.hpc.wehi.edu.au</span></span></code></pre>
</div>
<p>So, we’re definitely on the remote machine.</p>
</div>
</div>
</div>
</div>
<div id="exercise-3-find-out-which-directory-we-are-in." class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-3-find-out-which-directory-we-are-in." class="callout-inner">
<h3 class="callout-title">Exercise 3: Find out which directory we are in.</h3>
<div class="callout-content">

</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<p>Run <code>pwd</code> (<strong>p</strong>rint the
<strong>w</strong>orking <strong>d</strong>irectory.)</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="bu">pwd</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>/home/users/allstaff/&lt;username&gt;</code></pre>
</div>
<p>Instead of <code>&lt;username&gt;</code>, your username will appear.
This is your HOME directory (<code>$HOME</code>)</p>
</div>
</div>
</div>
</div>
<div id="exercise-4-list-all-files-and-folders-in-your-home-directory" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-4-list-all-files-and-folders-in-your-home-directory" class="callout-inner">
<h3 class="callout-title">Exercise 4: List all files and folders in your Home directory</h3>
<div class="callout-content">

</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">ls</span></span></code></pre>
</div>
<p>will print a list of files/directories in the directory.</p>
</div>
</div>
</div>
</div>
<div id="exercise-5-copy-exercise-examples-to-your-vast-scratch-or-home-directory" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-5-copy-exercise-examples-to-your-vast-scratch-or-home-directory" class="callout-inner">
<h3 class="callout-title">Exercise 5: Copy Exercise examples to your vast scratch or home directory</h3>
<div class="callout-content">
<p>copy exercise examples from
<code>/stornext/System/data/apps/sample-scripts/Workshop-IntroToHPC-Slurm</code>
to current directory,</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5"> Show me the solution </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="bu">cd</span> <span class="op">&lt;</span>dir<span class="op">&gt;</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">cp</span> <span class="at">-r</span>  /stornext/System/data/apps/sample-scripts/Workshop-IntroToHPC-Slurm .</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="fu">ls</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="exercise-6-disconnect-your-session" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-6-disconnect-your-session" class="callout-inner">
<h3 class="callout-title">Exercise 6: Disconnect your session</h3>
<div class="callout-content">

</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6"> Show me the solution </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" aria-labelledby="headingSolution6" data-bs-parent="#accordionSolution6">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="bu">exit</span></span></code></pre>
</div>
<p>or</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="bu">logout</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>For more on Linux commands, visit <a href="https://wehieduau.sharepoint.com/sites/rc2/SitePages/Linux.aspx" class="external-link">our
guide</a> or watch the recording of the workshops <a href="https://wehieduau.sharepoint.com/sites/rc2/SitePages/RCP-Training.aspx" class="external-link">here</a></p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>HPC systems typically provide login nodes and a set of compute
nodes.</li>
<li>Files saved on one node are available on all nodes.</li>
<li>Milton has multiple different file systems that have different
policies and characteristics.</li>
<li>Throughout a research project, research data may move between file
systems according to backup and retention requirements, and to improve
performance.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-03-modules"><p>Content from <a href="03-modules.html">Environment Modules</a></p>
<hr>
<p>Last updated on 2023-05-16 |

        <a href="https://github.com/WEHI-ResearchComputing/Workshop-IntroToHPC-Slurm/edit/main/episodes/03-modules.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do we load and unload software packages?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Load and use a software package.</li>
<li>Explain how the shell environment changes when the module mechanism
loads or unloads packages.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>On Milton, many softwares are installed but need to be loaded before
you can run it.</p>
<section><h2 class="section-heading" id="why-do-we-need-environment-modules">Why do we need Environment Modules?<a class="anchor" aria-label="anchor" href="#why-do-we-need-environment-modules"></a>
</h2>
<hr class="half-width">
<ul>
<li>software incompatibilities</li>
<li>versioning</li>
<li>dependencies</li>
</ul>
<p>Software incompatibility is a major headache for programmers.
Sometimes the presence (or absence) of a software package will break
others that depend on it.</p>
<p>Two of the most famous examples are Python 2 and 3 and C compiler
versions. Python 3 famously provides a <code>python</code> command that
conflicts with that provided by Python 2. Software compiled against a
newer version of the C libraries and then used when they are not present
will result in errors.</p>
<p>Software versioning is another common issue. A team might depend on a
certain package version for their research project - if the software
version was to change (for instance, if a package was updated), it might
affect their results. Having access to multiple software versions allow
a set of researchers to prevent software versioning issues from
affecting their results.</p>
<p>Dependencies are where a particular software package (or even a
particular version) depends on having access to another software package
(or even a particular version of another software package).</p>
<p>Environment modules are the solution to these problems. A
<em>module</em> is a self-contained description of a software package –
it contains the settings required to run a software package and,
usually, encodes required dependencies on other software packages. HPC
facilities will often have their own optimised versions of some
software, so modules also make it easier to use these versions.</p>
</section><section><h2 class="section-heading" id="module-command">
<code>module</code> command<a class="anchor" aria-label="anchor" href="#module-command"></a>
</h2>
<hr class="half-width">
<p>The <code>module</code> command is used to interact with environment
modules. An additional subcommand is usually added to the command to
specify what you want to do. For a list of subcommands you can use
<code>module -h</code> or <code>module help</code>. As for all commands,
you can access the full help on the <em>man</em> pages with
<code>man module</code>.</p>
<div class="section level3">
<h3 id="listing-available-modules">Listing Available Modules<a class="anchor" aria-label="anchor" href="#listing-available-modules"></a>
</h3>
<p>To see available software modules, use <code>module avail</code>:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">module</span> avail</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>------------------------------------------ /stornext/System/data/modulefiles/tools -------------------------------------------
apptainer/1.0.0            go/1.19.4                    mpich-slurm/3.4.1                   openmpi/4.1.1-slurm
apptainer/1.1.0            go/1.20.2                    mpich-slurm/3.4.2                   openMPI/4.1.4
aspera/3.5.4               groovy/4.0.0                 mpich/3.3                           openSSL/1.0.2r
aspera/3.9.1               gzip/1.10                    mpich/3.3.2                         openSSL/1.1.1b
aspera/3.9.6               hdf5-mpich/1.10.5_3.3        ncftp/3.2.6                         openSSL/1.1.1g
awscli/1.16py2.7           hpl/2.3                      netcdf_c/4.9.2                      openSSL/1.1.1k
awscli/1.16py3.7           icewm/2.8.0                  nextflow-tw-agent/0.5.0             openSSL/1.1.1n
awscli/1.22.89             iftop/1.0                    nextflow/22.04.5                    owncloud-client/2.3.3
awscli/2.1.25              ImageMagick/6.9.11-22        nextflow/22.10.4                    pandoc/2.14.2
awscli/2.5.2               ImageMagick/7.0.9-5          nf-core/2.7.2                       pandoc/2.19.2
axel/2.17.10               intel-ipp/2019.5.281         ninja/1.10.0                        pgsql/15.1
bazel/0.26.1               intel-mkl/2019.3.199         nmap-ncat/7.91                      pigz/2.6
bazel/1.2.1                intel-mpi/2019.3.199         nodejs/10.24.1                      pmix/2.2.5
binutils/2.35.2-gcc-4.8.5  intel-tbb/2019.3.199         nodejs/16.19.0                      pmix/3.2.3
binutils/2.35.2-gcc-9.1.0  intel_mkl_2019/2019.5.075    nodejs/17.9.1                       pmix/4.2.3
cluster-utils/18.08.1      intel_mpi_2019/2019.5.075    ocl-icd/2.3.1                       poetry/latest
cmake/3.25.1               ior-slurm/3.2.1mpich3.3      octave/6.4.0-gcc11.1.0              proj/4.9.3
CUnit/2.1-3                ior-slurm/3.2.1openMPI4.0.2  oneMKL/2022.1.0.223                 proj/6.3.2
curl/7.65.0                ior/3.2.1mpio4.0.1           openBLAS/0.3.6-gcc-9.1.0            proj/9.1.0
depot_tools/6c7b829        iozone/3.491                 openBLAS/0.3.21-gcc-11.1.0          qpdf/10.0.1
dotnet/2.1.809             julia/0.6.4                  openBLAS/0.3.21-gcc-11.1.0-skylake  quarto/1.1.189
dotnet/3.1.412             julia/1.0.1                  openBLAS/0.3.23-gcc-11.3.0          rclone/1.55.0
dotnet/6.0.408             julia/1.5.3                  openCV/2.4.13.6                     rstudio_singularity/1.0.0
doublecmd/0.9.10.gtk2      julia/1.8.5                  openCV/4.2.0                        slurm-contribs/20.11.5
dua-cli/2.17.8             libaio/0.3.111               openjdk/1.8.0                       snakemake/7.12.0
dua-cli/2.19.0             libiconv/1.16                openjdk/13.0.2                      sqlite/3.38.5
duckdb/0.6.1               lz4/1.9.3                    openjdk/14.0.2                      sqlite/3.40.0
elbencho/1.7-1cu10.1       mariadb-client/10.11.2       openjdk/15.0.2                      sqlite/3.40.1
evince/3.28.2              mariadb-connector-c/3.1.11   openjdk/16.0.1                      stornext/1.1
feh/3.6.3                  mariadb-connector-c/3.3.4    openjdk/17.0.2                      stubl/0.0.10
fftw/3.3.9                 maven/3.3.9                  openjdk/18.0.2                      tar/1.34
fio/3.16                   maven/3.9.1                  openMPI-slurm/4.1.0                 tcpdump/4.9.2</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="listing-currently-loaded-modules">Listing Currently Loaded Modules<a class="anchor" aria-label="anchor" href="#listing-currently-loaded-modules"></a>
</h3>
<p>You can use the <code>module list</code> command to see which modules
you currently have loaded in your environment. If you have no modules
loaded, you will see a message telling you so</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">module</span> list</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>No Modulefiles Currently Loaded.</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="loading-and-unloading-software">Loading and Unloading Software<a class="anchor" aria-label="anchor" href="#loading-and-unloading-software"></a>
</h3>
<p>To load a software module, use <code>module load</code>. In this
example we will use Python 3.</p>
<p>Initially, Python 3 is not loaded. We can test this by using the
<code>which</code> command. <code>which</code> looks for programs the
same way that Bash does, so we can use it to tell us where a particular
piece of software is stored.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">which</span> python3</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>/usr/bin/python3</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">python3</span> <span class="at">--version</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Python 3.6.8</code></pre>
</div>
<p>We can look at the available <code>python</code> modules on
Milton</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="ex">module</span> avail python</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>---------------------------------------- /stornext/System/data/modulefiles/bioinf/its ----------------------------------------
python/2.7.18  python/3.5.3        python/3.7.0   python/3.8.3  python/3.9.5   python/3.11.2
python/3.5.1   python/3.6.5-intel  python/3.7.13  python/3.8.8  python/3.10.4</code></pre>
</div>
<p>Now, we can load the <code>python 3.11.2</code> command with
<code>module load</code>:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="ex">module</span> load python/3.11.2</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="ex">python3</span> <span class="at">--version</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Python 3.11.2</code></pre>
</div>
<p>Using <code>module unload</code> “un-loads” a module along with its
dependencies. If we wanted to unload everything at once, we could run
<code>module purge</code> (unloads everything).</p>
<p>Now, if you already have a Python module loaded, and you try to load
a different version of Python 3, you will get an error.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="ex">module</span> load python/3.8.8</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Loading python/3.8.8
  ERROR: Module cannot be loaded due to a conflict.
    HINT: Might try "module unload python" first.</code></pre>
</div>
<p>You will need to <code>module switch</code> to Python 3.8.8 instead
of <code>module load</code>.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="ex">module</span> switch  python/3.8.8</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="ex">module</span> list</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Currently Loaded Modulefiles:
 1) python/3.8.8</code></pre>
</div>
<div id="exercise-1-what-does-module-whatis-python-do" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-1-what-does-module-whatis-python-do" class="callout-inner">
<h3 class="callout-title">Exercise 1: What does
<code>module whatis python</code> do?</h3>
<div class="callout-content">

</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>Print information of modulefile(s)</p>
</div>
</div>
</div>
</div>
<div id="exercise-2-what-does-module-show-python-do" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-2-what-does-module-show-python-do" class="callout-inner">
<h3 class="callout-title">Exercise 2: What does
<code>module show python</code> do?</h3>
<div class="callout-content">

</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>Show the changes loading the module does to your environment</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="ex">module</span> show python</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>-------------------------------------------------------------------
/stornext/System/data/modulefiles/bioinf/its/python/3.8.8:

module-whatis   {Python is a widely used high-level, general-purpose, interpreted, dynamic programming language. (v3.8.8)}
conflict        python
conflict        caffe2
conflict        anaconda2
conflict        anaconda3
conflict        CUDA8/caffe2
unsetenv        PYTHONHOME
setenv          PYTHON_INCLUDE_DIR /stornext/System/data/apps/python/python-3.8.8/include/python3.8
prepend-path    PATH /stornext/System/data/apps/python/python-3.8.8/bin
prepend-path    CPATH /stornext/System/data/apps/python/python-3.8.8/include/python3.8
prepend-path    MANPATH :/stornext/System/data/apps/python/python-3.8.8/share/man
prepend-path    LD_LIBRARY_PATH /stornext/System/data/apps/python/python-3.8.8/lib</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="what-is-path">What is <code>$PATH</code>?<a class="anchor" aria-label="anchor" href="#what-is-path"></a>
</h2>
<hr class="half-width">
<p><code>$PATH</code> is a special environment variable that controls
where a UNIX system looks for software. Specifically <code>$PATH</code>
is a list of directories (separated by <code>:</code>) that the OS
searches through for a command before giving up and telling us it can’t
find it. As with all environment variables we can print it out using
<code>echo</code>.</p>
<p>When we ran the <code>module load</code> command, it adds a directory
to the beginning of our <code>$PATH</code>. That is the way it “loads”
software and also loads required software dependencies. The module
loading process manipulates other special environment variables as well,
including variables that influence where the system looks for software
libraries, and sometimes variables which tell commercial software
packages where to find license servers.</p>
<p>The module command also restores these shell environment variables to
their previous state when a module is unloaded.</p>
<div id="note" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="note" class="callout-inner">
<h3 class="callout-title">Note</h3>
<div class="callout-content">
<p>The login nodes are a <em>shared resource</em>. All users access a
login node in order to check their files, submit jobs etc. If one or
more users start to run computationally or I/O intensive tasks on the
login node (such as forwarding of graphics, copying large files, running
multicore jobs), then that will make operations difficult for
everyone.</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Load software with <code>module load softwareName</code>.</li>
<li>Unload software with <code>module unload</code> or
<code>module purge</code>.</li>
<li>The module system handles software versioning and package conflicts
for you automatically.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-04-break"><p>Content from <a href="04-break.html">Lunch Break</a></p>
<hr>
<p>Last updated on 2023-05-15 |

        <a href="https://github.com/WEHI-ResearchComputing/Workshop-IntroToHPC-Slurm/edit/main/episodes/04-break.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<p>Take a 30-minutes lunch break.</p>
<p>Make sure you move around and look at something away from your screen
to give your eyes a rest.</p></section><section id="aio-05-slurm"><p>Content from <a href="05-slurm.html">Introducing Slurm</a></p>
<hr>
<p>Last updated on 2023-05-16 |

        <a href="https://github.com/WEHI-ResearchComputing/Workshop-IntroToHPC-Slurm/edit/main/episodes/05-slurm.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is a scheduler and why does a cluster need one?</li>
<li>What is a partition?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain what is a scheduler</li>
<li>Explain how Milton’s Slurm works</li>
<li>Identify the essential options to set for a job</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="job-scheduler">Job Scheduler<a class="anchor" aria-label="anchor" href="#job-scheduler"></a>
</h2>
<hr class="half-width">
<p>An HPC system might have thousands of nodes and thousands of users. A
<em>scheduler</em> is a special piece of software that decides which
jobs run where and when. It also ensures that a task is run with the
resources it requested.</p>
<p>The following illustration compares these tasks of a job scheduler to
a waiter in a restaurant. If you can relate to an instance where you had
to wait for a while in a queue to get in to a popular restaurant, then
you may now understand why sometimes your job do not start instantly as
in your laptop.</p>
<figure><img src="fig/restaurant_queue_manager.svg" alt="Compare a job scheduler to a waiter in a restaurant" class="figure mx-auto d-block"><div class="figcaption">Compare a job scheduler to a waiter in a
restaurant</div>
</figure><p>Milton uses a scheduler (batch system) called Slurm. WEHI has 3500
physical cores, 44TB of memory, 58 GPUs and 90 nodes accessible by
Slurm.</p>
<p>The user describes the work to be done and resources required in a
script or at the command line, then submits the script to the batch
system. The work is scheduled when resources are available and
consistent with policy set by administrators.</p>
</section><section><h2 class="section-heading" id="slurm">Slurm<a class="anchor" aria-label="anchor" href="#slurm"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="simple-linux-utility-for-resource-management">
<a href="https://Slurm.schedmd.com/documentation.html" class="external-link">Simple Linux
Utility for Resource Management</a><a class="anchor" aria-label="anchor" href="#simple-linux-utility-for-resource-management"></a>
</h3>
<p>Slurm development has been a joint effort of many companies and
organizations around the world. Over 200 individuals have contributed to
Slurm. Its development is lead by <a href="https://www.schedmd.com/" class="external-link">SchedMD</a>. Its staff of developers and
support personnel maintain the canonical Slurm releases, and are
responsible for the majority of the development work for each new Slurm
release. Slurm’s design is very modular with about 100 optional plugins.
It is used at Spartan, Massive, Pawsey, Peter Mac and Milton, as well as
HPC facilities world-wide.</p>
<figure><img src="fig/SlurmImg.gif" alt="Slurm architecture diagram" class="figure mx-auto d-block"><div class="figcaption">Slurm architecture diagram</div>
</figure>
</div>
<div class="section level3">
<h3 id="fair-share">Fair Share<a class="anchor" aria-label="anchor" href="#fair-share"></a>
</h3>
<p>A cluster is a shared environment and when there is more work than
resources available, there needs to be a mechanism to resolve
contention. Policies ensure that everyone has a “fair share” of the
resources.</p>
<p>Milton uses a <a href="https://Slurm.schedmd.com/priority_multifactor.html#mfjppintro" class="external-link">multifactor
job priority policy</a>. It uses nine factors that influence job
priority.</p>
<p>It is set such that:</p>
<ul>
<li>age: as the length of time a job has been waiting in the queue
increases, the job priority increases.</li>
<li>job size: the more resources (CPUs, GPUs, and/or memory), the higher
priority.</li>
<li>fair-share: the difference between the portion of the computing
resource that has been requested and the amount of resources that has
been consumed, i.e. the more resources your jobs have already used, the
lower the priority of your next jobs.</li>
</ul>
<p>In addition, no single user can have more than 8% of total CPUs or
memory, which is <strong>450 CPUs</strong> and <strong>3TB
memory</strong>.</p>
</div>
<div class="section level3">
<h3 id="backfilling">Backfilling<a class="anchor" aria-label="anchor" href="#backfilling"></a>
</h3>
<p>Milton uses a back-filling algorithm to improve system utilisation
and maximise job throughput.</p>
<p>When more resource intensive jobs are running it is possible that
gaps ends up in the resource allocation. To fill these gaps a best
effort is made for low-resource jobs to slot into these spaces.</p>
<p>For example, on an 8-core node, an 8 core job is running, a 4 core
job is launched, then an 8 core job, then another 4 core job. The two 4
core jobs will run before the second 8 core job.</p>
<p>if we have 2 8-core nodes, we receive:</p>
<ul>
<li>Job 1 request 4-cores and 5 hours limit</li>
<li>Job 2 request 8-cores and 2 hours limit</li>
<li>Job 3 request 4-cores and 4 hours limit</li>
</ul>
<p>Without back filling, Job 2 will block the queue and Job 3 will have
to wait until Job 2 is completed. With back filling, when Job 1 has been
allocated and Job 2 pending for resources, Slurm will look through the
queue, searching for jobs that are small enough to fill the idle node.
In this example, this means that Job 3 will start before Job 2 to
“back-fill” the 4 CPUs that will be available for 5 hours while Job 1 is
running.</p>
<figure><img src="fig/backfill.png" alt="Backfilling Algorithm" class="figure mx-auto d-block"><div class="figcaption">Backfilling Algorithm</div>
</figure>
</div>
</section><section><h2 class="section-heading" id="slurm-partitions">Slurm Partitions<a class="anchor" aria-label="anchor" href="#slurm-partitions"></a>
</h2>
<hr class="half-width">
<p>Partitions in Slurm group nodes into logical (possibly overlapping)
sets. A partition configuration defines job limits or access controls
for a group of nodes. Slurm allocates resources to jobs within the
selected partition by taking into consideration the resources you
request for your job and the partition’s available resources and
restrictions.</p>
<table style="width:100%;" class="table">
<colgroup>
<col width="13%">
<col width="16%">
<col width="13%">
<col width="16%">
<col width="13%">
<col width="16%">
<col width="9%">
</colgroup>
<thead><tr class="header">
<th align="center">Partition</th>
<th align="center">Purpose</th>
<th align="center">Max submitted jobs/user</th>
<th align="center">Max CPUs/user</th>
<th align="center">Max mem (GB)/user</th>
<th align="center">Max wall time/job</th>
<th align="center">Max GPUs/user</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">interactive</td>
<td align="center">interactive jobs</td>
<td align="center">1</td>
<td align="center">16</td>
<td align="center">64</td>
<td align="center">24 hours</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">regular</td>
<td align="center">most of the batch work</td>
<td align="center">5000</td>
<td align="center">454</td>
<td align="center">3000</td>
<td align="center">48 hours</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">long</td>
<td align="center">long-running jobs</td>
<td align="center"></td>
<td align="center">96</td>
<td align="center">500</td>
<td align="center">14-days</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">gpuq</td>
<td align="center">jobs that require GPUs</td>
<td align="center"></td>
<td align="center">192</td>
<td align="center">998</td>
<td align="center">48 hours</td>
<td align="center">8 GPUs on 2 nodes</td>
</tr>
<tr class="odd">
<td align="center">gpuq_large</td>
<td align="center">jobs that require A100 GPUs</td>
<td align="center"></td>
<td align="center">96</td>
<td align="center">1000</td>
<td align="center">48 hours</td>
<td align="center">1 A100</td>
</tr>
<tr class="even">
<td align="center">bigmem</td>
<td align="center">jobs that require large amounts of memory</td>
<td align="center">500</td>
<td align="center">128</td>
<td align="center">1400</td>
<td align="center">48 hours</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<hr></section><section><h2 class="section-heading" id="the-main-parameters-to-set-for-any-job-script">The main parameters to set for any job script<a class="anchor" aria-label="anchor" href="#the-main-parameters-to-set-for-any-job-script"></a>
</h2>
<hr class="half-width">
<ul>
<li>time: the maximum time for the job execution.</li>
<li>cpus: number of CPUs</li>
<li>partition: the partition in which your job is placed</li>
<li>memory: the amount of physical memory</li>
<li>special resources such as GPUs.</li>
</ul>
<p>We will discuss this more in the next episode.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>The scheduler handles how compute resources are shared between
users.</li>
<li>A job is just a shell script.</li>
<li>Request <em>slightly</em> more resources than you will need.</li>
<li>Backfilling improves system utilisation and maximises job
throughput. You can take advantage of backfilling by requesting only
what you need.</li>
<li>Milton Slurm has multiple partitions with different specification
that fit the different types of jobs.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-06-submit"><p>Content from <a href="06-submit.html">Submitting a Job</a></p>
<hr>
<p>Last updated on 2023-05-16 |

        <a href="https://github.com/WEHI-ResearchComputing/Workshop-IntroToHPC-Slurm/edit/main/episodes/06-submit.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I launch a program to run on a compute node in the
cluster?</li>
<li>How do I capture the output of a program that is run on a node in
the cluster?</li>
<li>How do I change resource requested or time-limit</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Submit a simple script to the cluster.</li>
<li>Monitor the execution of jobs using command line tools.</li>
<li>Inspect the output and error files of your jobs.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="running-a-batch-job">Running a Batch Job<a class="anchor" aria-label="anchor" href="#running-a-batch-job"></a>
</h2>
<hr class="half-width">
<p>The most basic use of the scheduler is to run a command
non-interactively. Any command (or series of commands) that you want to
run on the cluster is called a <em>job</em>, and the process of using a
scheduler to run the job is called <em>batch job submission</em>.</p>
<p>Basic steps are:</p>
<ul>
<li>Develop a submission script, a text file of commands, to perform the
work</li>
<li>Submit the script to the batch system with enough resource
specification</li>
<li>Monitor your jobs</li>
<li>Check script and command output</li>
<li>Evaluate your job</li>
</ul>
<p>In this episode, we will focus on the first 4 steps.</p>
<div class="section level3">
<h3 id="preparing-a-job-script">Preparing a job script<a class="anchor" aria-label="anchor" href="#preparing-a-job-script"></a>
</h3>
<p>In this case, the job we want to run is a shell script – essentially
a text file containing a list of Linux commands to be executed in a
sequential manner.</p>
<p>Our first shell script will have three parts:</p>
<ul>
<li>On the very first line, add <code>#!/bin/bash</code>. The
<code>#!</code> (pronounced “hash-bang” or “shebang”) tells the computer
what program is meant to process the contents of this file. In this
case, we are telling it that the commands that follow are written for
the command-line shell.</li>
<li>Anywhere below the first line, we’ll add an <code>echo</code>
command with a friendly greeting. When run, the shell script will print
whatever comes after <code>echo</code> in the terminal.
<ul>
<li>
<code>echo -n</code> will print everything that follows,
<em>without</em> ending the line by printing the new-line
character.</li>
</ul>
</li>
<li>On the last line, we’ll invoke the <code>hostname</code> command,
which will print the name of the machine the script is run on.</li>
</ul>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">nano</span> example-job.sh</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="bu">echo</span> <span class="at">-n</span> <span class="st">"This script is running on "</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">hostname</span></span></code></pre>
</div>
<div id="exercise-1-run-example-job.sh" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-1-run-example-job.sh" class="callout-inner">
<h3 class="callout-title">Exercise 1: Run example-job.sh</h3>
<div class="callout-content">
<p>Run the script. Does it execute on the cluster or just our login
node?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">bash</span> example-job.sh</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>This script is running on slurm-login01.hpc.wehi.edu.au</code></pre>
</div>
<p><code>slurm-login01.hpc.wehi.edu.au</code> may change depending on
which node you ssh’ed into to run the script.</p>
</div>
</div>
</div>
</div>
<p>This script ran on the login node, but we want to take advantage of
the compute nodes, we need the scheduler to queue up
<code>example-job.sh</code> to run on a compute node.</p>
</div>
<div class="section level3">
<h3 id="submit-a-batch-job">Submit a batch job<a class="anchor" aria-label="anchor" href="#submit-a-batch-job"></a>
</h3>
<p>To submit this task to the scheduler, we use the <code>sbatch</code>
command. This creates a <em>job</em> which will run the <em>script</em>
when <em>dispatched</em> to a compute node. The queuing system
identified which compute nose is available to perform the work.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">sbatch</span> example-job.sh</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Submitted batch job 11783863</code></pre>
</div>
<p>And that’s all we need to do to submit a job. Our work is done – now
the scheduler takes over and tries to run the job for us.</p>
</div>
</section><section><h2 class="section-heading" id="monitor-your-batch-job">Monitor your batch job<a class="anchor" aria-label="anchor" href="#monitor-your-batch-job"></a>
</h2>
<hr class="half-width">
<p>While the job is waiting to run, it goes into a list of jobs called
the <em>queue</em>. To check on our job’s status, we check the queue
using the command <code>squeue -u $USER</code>.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">squeue</span> <span class="at">-u</span> <span class="va">$USER</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>     JOBID    PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
    11783909   regular example- iskander  R       0:06      1 sml-n02</code></pre>
</div>
<p>ST is short for status and can be R (RUNNING), PD (PENDING), CA
(CANCELLED), or CG (COMPLETING). If the job is stuck in pending, REASON
column will reflect the reason, which can be one of the following:</p>
<ul>
<li>Priority: There are higher priority jobs than yours</li>
<li>Resources: Job is waiting for resources</li>
<li>Dependency: This job is dependent on another and it is waiting for
that other job to complete</li>
<li>QOSMaxCpuPerUserLimit: User has used CPUs limit of partition
already</li>
<li>QOSMaxMemPerUserLimit: User has used memory limit of partition
already</li>
</ul></section><section><h2 class="section-heading" id="wheres-the-output">Where’s the Output?<a class="anchor" aria-label="anchor" href="#wheres-the-output"></a>
</h2>
<hr class="half-width">
<p>On the login node, this script printed output to the terminal – but
now, when the job has finished, nothing was printed to the terminal.
Cluster job output is typically redirected to a file in the directory
you launched it from. By default, the output file is called
<code>slurm-&lt;jobid&gt;.out</code></p>
<p>Use <code>ls</code> to find and <code>cat</code> to read the
file.</p>
<div id="exercise-2-get-output-of-running-example-job.sh-in-slurm" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-2-get-output-of-running-example-job.sh-in-slurm" class="callout-inner">
<h3 class="callout-title">Exercise 2: Get output of running example-job.sh in Slurm</h3>
<div class="callout-content">
<p>List files in your currrent working directory and look for a file
<code>Slurm-11783909.out</code>, <code>11783909</code> will change
according to your job id. And cat the file to see output.</p>
<p>What is the hostname of your job?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">cat</span> slurm-11783863.out</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>This script is running on sml-n02.hpc.wehi.edu.au</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="customising-a-job">Customising a Job<a class="anchor" aria-label="anchor" href="#customising-a-job"></a>
</h2>
<hr class="half-width">
<p>The job we just ran used all of the scheduler’s default options. In a
real-world scenario, that’s probably not what we want. Chances are, we
will need more cores, more memory, more/less time, among other special
considerations. To get access to these resources we must customize our
job script.</p>
<p>The default parameters on Milton is 2 CPU, 10MB Ram, 48-hours
time-limit and runs on the regular partition</p>
<p>After your job has completed, you can get details of the job using
<code>sacct</code> command.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="ex">sacct</span> <span class="at">-j</span> 11783909 <span class="at">-ojobid,jobname,ncpus,reqmem,timelimit,partition</span> <span class="at">-X</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>JobID           JobName      NCPUS     ReqMem  Timelimit  Partition
------------ ---------- ---------- ---------- ---------- ----------
11783909     example-j+          2        10M 2-00:00:00    regular</code></pre>
</div>
<p>We can change the resource specification of the job by two ways:</p>
<p>Adding extra options to the <code>sbatch</code> command</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">--job-name</span> hello-world <span class="at">--mem</span> 1G <span class="at">--cpus-per-task</span> 1 <span class="at">--time</span> 1:00:00 example-job.sh</span></code></pre>
</div>
<p>Modifying the submission script</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="co">#SBATCH --job-name hello-world</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co">#SBATCH --mem 1G</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="co">#SBATCH --cpus-per-task 1</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="co">#SBATCH  --time 1:00:00</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="bu">echo</span> <span class="at">-n</span> <span class="st">"This script is running on "</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="fu">hostname</span></span></code></pre>
</div>
<p>Submit the job and monitor its status:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="ex">$</span> sbatch example-job.sh</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="ex">Submitted</span> batch job 11785584</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="ex">$</span> squeue <span class="at">-u</span> <span class="va">$USER</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>             <span class="ex">JOBID</span> PARTITION     NAME     USER ST       TIME  NODES NODELIST<span class="er">(</span><span class="ex">REASON</span><span class="kw">)</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>          <span class="ex">11785584</span>   regular hello-wo iskander  R       0:01      1 sml-n20</span></code></pre>
</div>
<p>Comments in shell scripts (denoted by <code>#</code>) are typically
ignored, but there are exceptions. Schedulers like SLURM have a special
comment used to denote special scheduler-specific options. Though these
comments differ from scheduler to scheduler, SLURM’s special comment is
<code>#SBATCH</code>. Anything following the <code>#SBATCH</code>
comment is interpreted as an instruction to the scheduler. These SBATCH
commands are also know as <code>SBATCH directives</code>.</p>
<p><strong>Remember</strong> Slurm directives must be at the top of the
script, below the “hash bang”. No command can come before them, nor in
between them.</p>
</section><section><h2 class="section-heading" id="resource-requests">Resource Requests<a class="anchor" aria-label="anchor" href="#resource-requests"></a>
</h2>
<hr class="half-width">
<p>One thing that is absolutely critical when working on an HPC system
is specifying the resources required to run a job. This allows the
scheduler to find the right time and place to schedule our job. As we
have seen before, if you do not specify requirements, you will be stuck
with default resources, which is probably not what you want.</p>
<p>The following are several key resource requests:</p>
<ul>
<li>
<code>--time</code> or <code>-t</code> : Time (wall-time) required
for a job to run. The <days> part can be omitted. default = 48 hours on
the regular queue</days>
</li>
<li>
<code>--mem</code>: Memory requested per node in MiB. Add G to
specify GiB (e.g. 10G). There is also <code>--mem-per-cpu</code>.
default = 10M</li>
<li>
<code>--nodes</code> or <code>-N</code>: Number of nodes your job
needs to run on. default = 1</li>
<li>
<code>--cpus-per-task</code> or <code>-c</code> Number of CPUs for
each task. Use this for threads/cores in single-node jobs.</li>
<li>
<code>--partition</code> or <code>-p</code>: the partition in which
your job is placed. default = regular</li>
<li>
<code>--ntasks</code> or <code>-n</code> : Number of tasks (used for
distributed processing, e.g. MPI workers). There is also
<code>--ntasks-per-node</code>. default = 1<br>
</li>
<li>
<code>--gres</code>: special resources such as GPUs. To specify
gpus, use gpu:<type>:<number>, for example,
<code>gres=gpu:P100:1</code>, and <strong>you must specify the correct
queue (gpuq or gpuq_large)</strong></number></type>
</li>
</ul>
<p>Note that just <em>requesting</em> these resources does not make your
job run faster, nor does it necessarily mean that you will consume all
of these resources. It only means that these are made available to you.
Your job may end up using less memory, or less time, or fewer nodes than
you have requested, and it will still run. It’s best if your requests
accurately reflect your job’s requirements.</p>
<p>In summary, the <strong>main parts of a <em>SLURM</em> submission
script</strong></p>
<p><strong>1. #! line</strong>:</p>
<p>This must be the first line of your SBATCH/Slurm script.</p>
<p><code>#!/bin/bash</code></p>
<p><strong>2. Resource Request</strong>:</p>
<p>This is to set the amount of resources required for the job.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co">#SBATCH --job-name=TestJob</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="co">#SBATCH --time=00:10:00</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="co">#SBATCH --ntasks=1</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="co">#SBATCH --cpus-per-task=1</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="co">#SBATCH --mem=500M</span></span></code></pre>
</div>
<p><strong>3. Job Steps</strong></p>
<p>Specify the list of tasks to be carried out. It may include an
initial load of all the modules that the project depends on to execute.
For example, if you are working on a python project, you’d definitely
require the python module to run your code.
<code>bash   module load python   echo "Start process"   hostname   sleep 30   python myscript.py   echo "End"</code>
All the next exercises will use scripts saved in the exercise folder
which you should have moved to your current directory.</p>
<div id="exercise-3-setting-appropriate-wall-time" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-3-setting-appropriate-wall-time" class="callout-inner">
<h3 class="callout-title">Exercise 3: Setting appropriate wall-time</h3>
<div class="callout-content">
<p>List then run job1.sh script in the batch system. What is the output?
Is there an error? How to fix it?</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="co">#SBATCH -t 00:01:00 </span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="bu">echo</span> <span class="at">-n</span> <span class="st">"This script is running on "</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="fu">sleep</span> 80 <span class="co"># time in seconds</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="fu">hostname</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<p>After 1 minute the job ends and the output is similar to this</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">cat</span> slurm-11792811.out </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>This script is running on Slurmstepd: error: *** JOB 11792811 ON sml-n24 CANCELLED AT 2023-05-13T20:41:10 DUE TO TIME LIMIT ***</code></pre>
</div>
<p>To fix it, change the script to</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="co">#SBATCH -t 00:01:20 # timeout in HH:MM</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="bu">echo</span> <span class="at">-n</span> <span class="st">"This script is running on "</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="fu">sleep</span> 70 <span class="co"># time in seconds</span></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a><span class="fu">hostname</span></span></code></pre>
</div>
<p>Try running again.</p>
</div>
</div>
</div>
</div>
<p>Resource requests are typically binding. If you exceed them, your job
will be killed.</p>
<p>The job was killed for exceeding the amount of resources it
requested. Although this appears harsh, this is actually a feature.
Strict adherence to resource requests allows the scheduler to find the
best possible place for your jobs. Even more importantly, it ensures
that another user cannot use more resources than they’ve been given. If
another user messes up and accidentally attempts to use all of the cores
or memory on a node, Slurm will either restrain their job to the
requested resources or kill the job outright. Other jobs on the node
will be unaffected. This means that one user cannot mess up the
experience of others, the only jobs affected by a mistake in scheduling
will be their own.</p>
<div id="exercise-4-setting-appropriate-slurm-directives" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-4-setting-appropriate-slurm-directives" class="callout-inner">
<h3 class="callout-title">Exercise 4: Setting appropriate Slurm directives</h3>
<div class="callout-content">
<p>List then run job2.sh script in the batch system. What is the output?
Is there an error? How can you fix it?</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="co">#SBATCH -t 00:01:00</span></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="co">#SBATCH --gres gpu:P100:1</span></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="co">#SBATCH  --mem 1G</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a><span class="co">#SBATCH --cpus-per-task 1</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="co">#This is  a job that needs GPUs</span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a><span class="bu">echo</span> <span class="at">-n</span> <span class="st">"This script is running on "</span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a><span class="fu">hostname</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<p>When submitting to Slurm, you get an error</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="ex">sbatch</span> job2.sh</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>sbatch: error: Batch job submission failed: Requested node configuration is not available</code></pre>
</div>
<p>This is because a GPU was requested without specifying the correct
GPU partition, so the regular partition was used which has no GPUs. To
fix it, change the script to</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="co">#SBATCH -t 00:01:00</span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a><span class="co">#SBATCH -p gpuq</span></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a><span class="co">#SBATCH --gres gpu:P100:1</span></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a><span class="co">#SBATCH  --mem 1G</span></span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a><span class="co">#SBATCH --cpus-per-task 1</span></span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a><span class="co">#This is  a job that needs GPUs</span></span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a><span class="bu">echo</span> <span class="at">-n</span> <span class="st">"This script is running on "</span></span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a><span class="fu">hostname</span></span></code></pre>
</div>
<p>Try running again.</p>
</div>
</div>
</div>
</div>
<div id="exercise-5" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-5" class="callout-inner">
<h3 class="callout-title">Exercise 5</h3>
<div class="callout-content">
<p>Make alignment job (<code>job3.sh</code>) work.</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5"> Show me the solution </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<p>Add the correct Slurm directives to the start of the script</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="co">#SBATCH --job-name=Bowtie-test.Slurm</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="co">#SBATCH --ntasks=1</span></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a><span class="co">#SBATCH -t 0:15:00</span></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a><span class="co">#SBATCH --mem 20G</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="exercise-6-run-job3.sh-again-and-monitor-progress-on-the-node-." class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-6-run-job3.sh-again-and-monitor-progress-on-the-node-." class="callout-inner">
<h3 class="callout-title">Exercise 6: Run job3.sh again and monitor progress on the node .</h3>
<div class="callout-content">
<p>Run <code>job3.sh</code> again and monitor progress on the node. You
can do this by sshing to the node and running <code>top</code>.</p>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6"> Show me the solution </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" aria-labelledby="headingSolution6" data-bs-parent="#accordionSolution6">
<div class="accordion-body">
<ul>
<li>Run the job</li>
<li>Get which node it is running on from
<code>squeue -u $USER</code>
</li>
<li>ssh into the node</li>
<li>use <code>top -u $USER</code>
</li>
</ul>
</div>
</div>
</div>
</div>
<p>We can have a live-demo on how to monitor a running job on the
compute node, using <code>top</code>, <code>iotop</code> and
<code>nvtop</code> for GPU nodes</p>
</section><section><h2 class="section-heading" id="cancelling-a-job">Cancelling a Job<a class="anchor" aria-label="anchor" href="#cancelling-a-job"></a>
</h2>
<hr class="half-width">
<p>Sometimes we’ll make a mistake and need to cancel a job. This can be
done with the <code>scancel</code> command. Let’s submit a job and then
cancel it using its job number.</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="ex">sbatch</span> example-jobwithsleep.sh</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a><span class="ex">Submitted</span> batch job 11785772</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a><span class="ex">$</span> squeue <span class="at">-u</span> <span class="va">$USER</span></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>             <span class="ex">JOBID</span> PARTITION     NAME     USER ST       TIME  NODES NODELIST<span class="er">(</span><span class="ex">REASON</span><span class="kw">)</span></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>          <span class="ex">11785772</span>   regular example- iskander  R       0:10      1 sml-n20</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a><span class="ex">$</span> scancel 11785772</span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a><span class="ex">$</span> squeue <span class="at">-u</span> <span class="va">$USER</span></span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a>             <span class="ex">JOBID</span> PARTITION     NAME     USER ST       TIME  NODES NODELIST<span class="er">(</span><span class="ex">REASON</span><span class="kw">)</span></span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a><span class="ex">$</span></span></code></pre>
</div>
<p>We can also cancel all of our jobs at once using the -u option. This
will delete all jobs for a specific user (in this case, yourself). Note
that you can only delete your own jobs.</p>
<p>Try submitting multiple jobs and then cancelling them all.</p>
<div id="exercise-7-submit-multiple-jobs-and-then-cancel-them-all." class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-7-submit-multiple-jobs-and-then-cancel-them-all." class="callout-inner">
<h3 class="callout-title">Exercise 7: Submit multiple jobs and then cancel them all.</h3>
<div class="callout-content">

</div>
</div>
</div>
<div id="accordionSolution7" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution7" aria-expanded="false" aria-controls="collapseSolution7">
  <h4 class="accordion-header" id="headingSolution7"> Show me the solution </h4>
</button>
<div id="collapseSolution7" class="accordion-collapse collapse" aria-labelledby="headingSolution7" data-bs-parent="#accordionSolution7">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="ex">sbatch</span> job1.sh</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a><span class="ex">sbatch</span> job1.sh</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a><span class="ex">sbatch</span> job1.sh</span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a><span class="ex">sbatch</span> job1.sh</span></code></pre>
</div>
<p>Check what you have in the queue</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="ex">squeue</span> <span class="at">-u</span> <span class="va">$USER</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          11792908   regular  job1.sh iskander  R       0:13      1 sml-n23
          11792909   regular  job1.sh iskander  R       0:13      1 sml-n23
          11792906   regular  job1.sh iskander  R       0:16      1 sml-n23
          11792907   regular  job1.sh iskander  R       0:16      1 sml-n23</code></pre>
</div>
<p>Cancel the jobs</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="ex">$</span> scancel <span class="at">-u</span> <span class="va">$USER</span></span></code></pre>
</div>
<p>Recheck the queue</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="ex">$</span> squeue <span class="at">-u</span> <span class="va">$USER</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>             <span class="ex">JOBID</span> PARTITION     NAME     USER ST       TIME  NODES NODELIST<span class="er">(</span><span class="ex">REASON</span><span class="kw">)</span></span></code></pre>
</div>
<p>And the queue is empty.</p>
</div>
</div>
</div>
</div>
<p>You can check how busy the queue is through the <a href="http://dashboards.hpc.wehi.edu.au/d/main/main?orgId=1" class="external-link">Milton
dashboards</a></p>
</section><section><h2 class="section-heading" id="slurm-event-notification">Slurm Event notification<a class="anchor" aria-label="anchor" href="#slurm-event-notification"></a>
</h2>
<hr class="half-width">
<p>You can use <code>--mail-type</code> and <code>--mail-user</code> to
set SLURM to send you emails when certain events occurs, e.g. BEGIN,
END, FAIL, REQUEUE, ALL</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="co">#SBATCH --mail-type </span><span class="re">BEGIN</span></span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a><span class="co">#SBATCH --mail-user iskander.j@wehi.edu.au</span></span></code></pre>
</div>
<p>Adding the above two lines to a submission script will make Slurm
send me an email when my job starts running.</p>
</section><section><h2 class="section-heading" id="slurm-output-files">Slurm Output files<a class="anchor" aria-label="anchor" href="#slurm-output-files"></a>
</h2>
<hr class="half-width">
<p>By default both standard output and standard error are directed to a
file of the name “slurm-%j.out”, where the “%j” is replaced with the job
id. The file will be saved in the submission directory as we saw before.
You can choose where the output files is saved and also separate
standard output from standard error using <code>--output</code> and
<code>--error</code></p>
<ul>
<li>
<code>--output</code> can be used to change the standard output
filename and location.</li>
<li>
<code>--error</code> can be used to specify where the standard
output file shall be saved. If not specified, it will be directed to the
standard output file.</li>
</ul>
<p>In the file names you can use:</p>
<ul>
<li>%j for job id</li>
<li>%N for host name</li>
<li>%u for user name</li>
<li>%x for job name</li>
</ul>
<p>For example, running the following</p>
<p><code>sbatch --error=/vast/scratch/users/%u/slurm%j_%N_%x.err --output=/vast/scratch/users/%u/slurm%j_%N_%x.out job1.sh</code>
will write error to <code>slurm12345678_sml-n01_job1.sh.err</code> and
output to <code>slurm12345678_sml-n01_job1.sh.out</code> in the
directory <code>/vast/scratch/users/&lt;username&gt;</code>, i.e. the
following will be created:</p>
<ul>
<li>a standard output file
<code>/vast/scratch/users/iskander.j/slurm11795785_sml-n21_job1.sh.out</code>
and</li>
<li>an error files
<code>/vast/scratch/users/iskander.j/slurm11795785_sml-n21_job1.sh.err</code>.</li>
</ul></section><section><h2 class="section-heading" id="bonus-qos-and-preemption">Bonus QoS and preemption<a class="anchor" aria-label="anchor" href="#bonus-qos-and-preemption"></a>
</h2>
<hr class="half-width">
<p>Before we move to our next lesson, let’s breiflt talk about the <a href="https://wehieduau.sharepoint.com/sites/rc2/SitePages/SLURM-partitions.aspx#slurm-bonus-qos%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B" class="external-link">bonus
QoS</a>. We have discussed before the limits of each partition. So what
if you have run many jobs and hit the limit on the regular partition but
when you look at the <a href="http://dashboards.hpc.wehi.edu.au/d/s/slurm?orgId=1&amp;refresh=10s" class="external-link">dashboards</a>
you observe that there are still free resources that can be used?</p>
<p><strong>Can you make use of them as long as <em>no one else needs
them</em>?</strong> Yes you can!</p>
<p>You can use <code>--qos=bonus</code>.</p>
<p>This will run your job in a preemptive mode, which means other users
can terminate your job, if Slurm couldn’t find other resources for their
jobs and they are using the normal QoS.</p>
<p>This is useful for jobs that can be resumed or restart is not an
issue.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>
<code>sbatch</code> is used to submit the job</li>
<li>
<code>squeue</code> is used to list jobs in the Slurm queue
<ul>
<li>passing the <code>-u &lt;username&gt;</code> option will show jobs
for just that user.</li>
</ul>
</li>
<li>
<code>sacct</code> is used to show job details</li>
<li>
<code>#SBATCH</code> directives are used in submission scripts to
set Slurm directives</li>
<li>Setting up job resources is a challenge and you might not get the
first time</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-07-evaluate"><p>Content from <a href="07-evaluate.html">Evaluating Jobs</a></p>
<hr>
<p>Last updated on 2023-05-16 |

        <a href="https://github.com/WEHI-ResearchComputing/Workshop-IntroToHPC-Slurm/edit/main/episodes/07-evaluate.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How to evaluate a completed job?</li>
<li>How to set event notification for your jobs?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain Slurm environment variables.</li>
<li>Demonstrate how to evaluate jobs and make use of multiple threads
options.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="evaluating-your-job">Evaluating your Job<a class="anchor" aria-label="anchor" href="#evaluating-your-job"></a>
</h2>
<hr class="half-width">
<p>After a job has completed, you will need to evaluate how efficient it
was, if it ran successfully, or investigate why it failed.</p>
<p>The <code>seff</code> command provides a summary of any job.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">seff</span> <span class="op">&lt;</span>jobid<span class="op">&gt;</span></span></code></pre>
</div>
<div id="exercise-1-run-and-evaluate-job4.sh-." class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-1-run-and-evaluate-job4.sh-." class="callout-inner">
<h3 class="callout-title">Exercise 1: Run and evaluate job4.sh .</h3>
<div class="callout-content">
<p>job4.sh is similar to job3.sh with only the <code>bowtie2</code>
command. Try submitting it. Is there an error? How to fix it?</p>
<p>And after it completed successfully, evaluate the job.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>The jobs completes fast but not successfully</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">seff</span> 11793501</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Job ID: 11793501
Cluster: milton
User/Group: iskander.j/allstaff
State: OUT_OF_MEMORY (exit code 0)
Nodes: 1
Cores per node: 2
CPU Utilized: 00:00:01
CPU Efficiency: 50.00% of 00:00:02 core-walltime
Job Wall-clock time: 00:00:01
Memory Utilized: 0.00 MB (estimated maximum)
Memory Efficiency: 0.00% of 20.00 MB (10.00 MB/core)</code></pre>
</div>
<p>Also, checking output</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">cat</span> Slurm-11793501.out</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>.........................&lt;other output&gt;
slurmstepd: error: Detected 1 oom_kill event in StepId=11793501.batch. Some of the step tasks have been OOM Killed.</code></pre>
</div>
<p>This shows that the job was “OOM Killed”. OOM is an abbreviation of
<strong>O</strong>ut <strong>O</strong>f <strong>M</strong>emory,
meaning the memory requested was not enough, increase memory and try
again until job finishes successfully.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co">#SBATCH --job-name=Bowtie-test.Slurm</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co">#SBATCH --ntasks=1</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#SBATCH -t 0:15:00</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#SBATCH --mem 1G</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="exercise-2-run-and-evaluate-job4.sh-." class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-2-run-and-evaluate-job4.sh-." class="callout-inner">
<h3 class="callout-title">Exercise 2: Run and evaluate job4.sh .</h3>
<div class="callout-content">
<p>Now that the job works fine can we make it faster.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>Investigate whether bowtie2 can make use of multiple threads to
accelerate run. Some tools does.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">bowtie2</span> <span class="at">--help</span></span></code></pre>
</div>
<p>Indeed bowtie, has a <code>-p</code> option that specifies number of
threads to use. Update the script to use 6 threads and also increase
cpus-per-tasks to reflect the increase in threads.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="slurm-environment-variables">Slurm Environment Variables<a class="anchor" aria-label="anchor" href="#slurm-environment-variables"></a>
</h2>
<hr class="half-width">
<p>Slurm passes information about the running job e.g what its working
directory, or what nodes were allocated for it, to the job via
environmental variables. In addition to being available to your job,
these are also used by programs to set options like number of threads to
run based on the cpus available.</p>
<p>The following is a list of commonly used variables that are set by
Slurm for each job</p>
<ul>
<li>
<code>$SLURM_JOBID</code>: Job id</li>
<li>
<code>$SLURM_SUBMIT_DIR</code>: Submission directory</li>
<li>
<code>$SLURM_SUBMIT_HOST</code>: Host submitted from</li>
<li>
<code>$SLURM_JOB_NODELIST</code>: list of nodes where cores are
allocated</li>
<li>
<code>$SLURM_CPUS_PER_TASK</code>: number of cores per task
allocated</li>
<li>
<code>$SLURM_NTASKS</code>: number of tasks assigned to job</li>
</ul>
<div id="exercise-3-run-job5.sh." class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-3-run-job5.sh." class="callout-inner">
<h3 class="callout-title">Exercise 3: Run job5.sh.</h3>
<div class="callout-content">
<p>Can we make use on of Slurm environment variables in job4.sh?</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<p>use <code>$SLURM_CPUS_PER_TASK</code> with <code>-p</code> option
instead of setting a number.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Use <code>seff</code> to evaluate completed jobs</li>
<li>Slurm Environment variables are handy to use in your script</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-08-break"><p>Content from <a href="08-break.html">Break</a></p>
<hr>
<p>Last updated on 2023-05-15 |

        <a href="https://github.com/WEHI-ResearchComputing/Workshop-IntroToHPC-Slurm/edit/main/episodes/08-break.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<p>Take a 30-minutes break. If you can, move around and look at
something away from your screen to give your eyes a rest.</p></section><section id="aio-09-commands"><p>Content from <a href="09-commands.html">Slurm Commands</a></p>
<hr>
<p>Last updated on 2023-05-15 |

        <a href="https://github.com/WEHI-ResearchComputing/Workshop-IntroToHPC-Slurm/edit/main/episodes/09-commands.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How to use Slurm commands?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to use the other Slurm commands?</li>
<li>Demonstrate different options for Slurm commands like
<code>squeue</code> and <code>sinfo</code>.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="slurm-commands-summary">Slurm Commands Summary<a class="anchor" aria-label="anchor" href="#slurm-commands-summary"></a>
</h2>
<hr class="half-width">
<table class="table">
<colgroup>
<col width="41%">
<col width="58%">
</colgroup>
<thead><tr class="header">
<th>Command</th>
<th>Action</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>sbatch &lt;script&gt;</code></td>
<td>Submit a batch script</td>
</tr>
<tr class="even">
<td><code>sacct</code></td>
<td>Display job details (accounting data)</td>
</tr>
<tr class="odd">
<td><code>sacctmgr</code></td>
<td>View account information</td>
</tr>
<tr class="even">
<td><code>squeue</code></td>
<td>View information of jobs currently in queue</td>
</tr>
<tr class="odd">
<td><code>squeue -j &lt;jobid&gt;</code></td>
<td>Get specific job details, job should be in the queue</td>
</tr>
<tr class="even">
<td><code>squeue -u &lt;userid&gt;</code></td>
<td>Get all queued job details for specified user</td>
</tr>
<tr class="odd">
<td><code>scancel &lt;jobid&gt;</code></td>
<td>Cancel job</td>
</tr>
<tr class="even">
<td><code>sinfo</code></td>
<td>View information about nodes and partitions</td>
</tr>
<tr class="odd">
<td><code>sinfo -N</code></td>
<td>View list of nodes</td>
</tr>
<tr class="even">
<td><code>sinfo -s</code></td>
<td>Provides nodes’ state information in each partitions</td>
</tr>
<tr class="odd">
<td><code>sinfo -p &lt;partition&gt;</code></td>
<td>Provides nodes’ state information in the specified partition</td>
</tr>
<tr class="even">
<td><code>scontrol show job &lt;jobid&gt;</code></td>
<td>View detailed job information</td>
</tr>
<tr class="odd">
<td><code>scontrol show partition &lt;partition&gt;</code></td>
<td>View detailed partition information</td>
</tr>
</tbody>
</table>
<div id="exercise-1-sinfo-with-options" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-1-sinfo-with-options" class="callout-inner">
<h3 class="callout-title">Exercise 1: sinfo with options</h3>
<div class="callout-content">
<p>What output does the following command produce?</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">sinfo</span> <span class="at">-p</span> gpuq <span class="at">-s</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>Provides summary information of only the specified partition</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>PARTITION AVAIL  TIMELIMIT   NODES(A/I/O/T) NODELIST
gpuq         up 2-00:00:00        2/10/0/12 gpu-a30-n[01-07],gpu-p100-n[01-05]</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="exercise-2-sinfo-with-options" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-2-sinfo-with-options" class="callout-inner">
<h3 class="callout-title">Exercise 2: sinfo with options</h3>
<div class="callout-content">
<p>What output does the following command produce?</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">sinfo</span> <span class="at">-p</span> gpuq <span class="at">-n</span> sml-n02</span></code></pre>
</div>
<p>Is there something missing in the output? How can we fix it?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>Provides information of the specified node in the specified
partition</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>PARTITION AVAIL  TIMELIMIT  NODES  STATE NODELIST
gpuq         up 2-00:00:00      0    n/a</code></pre>
</div>
<p>The results says that node is not available, this is because there is
no node called <code>sml-n02</code> in the regular partition. To fix it,
we can either change the partition to <code>regular</code> or the node
to something like <code>gpu-a30-n01</code></p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">sinfo</span> <span class="at">-p</span> regular <span class="at">-n</span> sml-n02</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>PARTITION AVAIL  TIMELIMIT  NODES  STATE NODELIST
regular*     up 2-00:00:00      1    mix sml-n02</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="exercise-3-squeue-with-formatting-option." class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-3-squeue-with-formatting-option." class="callout-inner">
<h3 class="callout-title">Exercise 3: squeue with formatting option.</h3>
<div class="callout-content">
<p>What output does the following command produce? Hint: check
<code>man squeue</code></p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">squeue</span> <span class="at">--format</span> <span class="st">"%.18i %.9P %.8j %.8u %.8T %.10M %.6C %.13l %.7D %.14r %.12m %.18N %.8Q"</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>JOBID      PARTITION   NAME    USER    STATE       TIME    CPUS    TIME_LIMIT    NODES      REASON        MIN_MEMORY        NODELIST      PRIORITY
11774748      gpuq    guppy    luo.q  PENDING       0:00     20    2-00:00:00       1 QOSMaxNodePerU         400G                        2060
11774747      gpuq    guppy    luo.q  PENDING       0:00     20    2-00:00:00       1 QOSMaxNodePerU         400G                        2060
11774746      gpuq    guppy    luo.q  PENDING       0:00     20    2-00:00:00       1 QOSMaxNodePerU         400G                        2060
11774744      gpuq    guppy    luo.q  RUNNING 1-05:28:48     20    2-00:00:00       1           None         400G        gpu-a30-n01     1366
11774745      gpuq    guppy    luo.q  RUNNING 1-05:41:49     20    2-00:00:00       1           None         400G        gpu-a30-n03     1360
          </code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="exercise-4-sinfo-with-formatting-option." class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-4-sinfo-with-formatting-option." class="callout-inner">
<h3 class="callout-title">Exercise 4: sinfo with formatting option.</h3>
<div class="callout-content">
<p>What output does the following command produce? Hint: you’ll want to
check the man page again!</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="ex">sinfo</span> <span class="at">--Node</span> <span class="at">--Format</span> <span class="st">"NodeList:21,Partition:11,StateLong:.11,CPUS:.5,Memory:.9,AllocMem:.9,Features:.20,CpusState:.14,GresUsed:.15"</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>NODELIST             PARTITION        STATE CPUS   MEMORY ALLOCMEM      AVAIL_FEATURES CPUS(A/I/O/T)      GRES_USED
cl-n01               bigmem            idle  192  3093716        0   Cooperlake,AVX512   0/192/0/192          gpu:0
gpu-a10-n01          gpuq_intera       idle   48   256215        0GPU,Icelake,A10,AVX5     0/48/0/48.     gpu:A10:0
gpu-a30-n01          gpuq             mixed   96   511362   409600GPU,Icelake,A30,AVX5    20/76/0/96.     gpu:A30:1
gpu-a30-n02          gpuq              idle   96   511362        0GPU,Icelake,A30,AVX5     0/96/0/96.     gpu:A30:0
gpu-a30-n03          gpuq             mixed   96   511362   409600GPU,Icelake,A30,AVX5    20/76/0/96.     gpu:A30:0
gpu-a30-n05          gpuq              idle   96   511362        0GPU,Icelake,A30,AVX5     0/96/0/96      gpu:A30:0
gpu-a30-n06          gpuq              idle   96   511362        0GPU,Icelake,A30,AVX5     0/96/0/96.     gpu:A30:0
gpu-a30-n07          gpuq              idle   96   511362        0GPU,Icelake,A30,AVX5     0/96/0/96.     gpu:A30:0
gpu-a100-n01         gpuq_large       mixed   96  1027457   819200GPU,Icelake,A100,AVX     2/94/0/96.     gpu:A100:1
gpu-a100-n02         gpuq_large       mixed   96  1027457   819200GPU,Icelake,A100,AVX     2/94/0/96.     gpu:A100:1
gpu-a100-n03         gpuq_large       mixed   96  1027457   819200GPU,Icelake,A100,AVX     2/94/0/96.     gpu:A100:1</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Slurm commands are handy to view information about queued jobs,
nodes and partitions</li>
<li>You will commonly use <code>sbatch</code>, <code>squeue</code>,
<code>salloc</code>, <code>sinfo</code> and <code>sacct</code>
</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-10-interactive"><p>Content from <a href="10-interactive.html">Interactive Slurm Jobs</a></p>
<hr>
<p>Last updated on 2023-05-15 |

        <a href="https://github.com/WEHI-ResearchComputing/Workshop-IntroToHPC-Slurm/edit/main/episodes/10-interactive.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How to start and exit an interactive Slurm job?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to use <code>salloc</code> to run interactive jobs</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="interactive-jobs">Interactive jobs<a class="anchor" aria-label="anchor" href="#interactive-jobs"></a>
</h2>
<hr class="half-width">
<p>Up to this point, we’ve focused on running jobs in batch mode. There
are frequently tasks that need to be done interactively. Creating an
entire job script might be overkill, but the amount of resources
required is too much for a login node to handle. To solve this, Slurm
provides the ability to start an interactive session.</p>
<p>Interactive sessions are <strong>commonly used</strong> for:</p>
<ul>
<li>Data management, eg. organising files, truncation and recall of
files, downloading datasets.</li>
<li>Software/workflow preparation/testing, eg. developing/debugging
scripts, downloading/building software.</li>
<li>Interactive data analysis.</li>
<li>Rapid analysis cycles.</li>
<li>Running n application with a GUI.</li>
</ul>
<p>On Milton, you can easily start an interactive job with
<code>salloc</code>.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">salloc</span> <span class="at">--time</span> 1:00:00 <span class="at">--cpus-per-task</span> 1 <span class="at">--mem</span> 1G  <span class="at">-p</span> interactive</span></code></pre>
</div>
<figure><img src="fig/salloc_ex.png" alt="salloc command example" class="figure mx-auto d-block"><div class="figcaption">salloc command example</div>
</figure><p>You will be presented with a bash prompt. Note that the prompt will
change to reflect your new location (<code>sml-n02</code> in the
example), which is the compute node we are logged onto. You can also
verify this with hostname.</p>
<p><strong>Remember</strong> that, you may have to wait for resources,
depending on the status of the queue you are requesting. We have
designed the interactive partition to provide high availability, but
only one job per user.</p>
<p>The interactive job will be cancelled and removed from the queue, if
your terminal session is terminated or closed, and/or internet
connection is lost (connection with the slurm node lost). It is
recommended to use <code>screen</code> or <code>tmux</code></p>
<p>When you have finished your task, please remember to close the
session using <code>exit</code> or <code>Ctrl-D</code>.</p>
<p>You can also cancel the session using <code>scancel</code>.</p>
<p>If you need more resources you can run interactive sessions in the
other partitions.</p>
<div id="these-instructions-are-specific-milton" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="these-instructions-are-specific-milton" class="callout-inner">
<h3 class="callout-title">These instructions are specific Milton!</h3>
<div class="callout-content">
<p><code>salloc</code> is setup slightly differently to its default
behaviour. Not all HPC facilities have Slurm to start interactive jobs
like in Milton! Be aware of this when using the command at other
facilities.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="creating-remote-graphics">Creating remote graphics<a class="anchor" aria-label="anchor" href="#creating-remote-graphics"></a>
</h2>
<hr class="half-width">
<p>To see graphical output inside your jobs, you need to use <em>X11
forwarding</em>. To connect with this feature enabled, use the
<code>-Y</code> option when you login to the login nodes or
vc7-shared.</p>
<pre><code>ssh -Y vc7-shared</code></pre>
<p>To use it in an interactive session add it to <code>--x11</code> to
your <code>salloc</code> command</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">salloc</span> <span class="at">--time</span> 1:00:00 <span class="at">--cpus-per-task</span> 1 <span class="at">--mem</span> 1G  <span class="at">-p</span> interactive <span class="at">--x11</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>salloc: Pending job allocation 11803274
salloc: job 11803274 queued and waiting for resources
salloc: job 11803274 has been allocated resources
salloc: Granted job allocation 11803274
salloc: Nodes sml-n03 are ready for job</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">module</span> load relion</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Loading Relion 3.1.3 using CUDA 11.2
Using MotionCor2 1.5.0 at /stornext/System/data/nvidia/motioncor2/motioncor2-1.5.0cu11.2/bin/motioncor2
No matching version of Gctf exists for CUDA 11.2
Using CTFFIND 4.1.14 at /stornext/System/data/nvidia/ctffind/ctffind-4.1.14/bin/ctffind

        WARNING: verify that the area where Relion will be used
        is not over its storage quota. If Relion is unable to write
        files this might cause severe corruption in the Relion
        pipeline star files.


Loading relion/3.1.3-cu11.2
  Loading requirement: cuda/11.2 mpich-slurm/3.4.2</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">relion</span></span></code></pre>
</div>
<figure><img src="fig/relion.png" class="figure mx-auto d-block"></figure><p>We will now have a live demo for more interactive options on
Milton.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Use <code>salloc</code> to start a new interactive Slurm job on
Milton.</li>
<li>Use <code>--x11</code> with <code>salloc</code> to run remote
graphics in your interactive job.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/WEHI-ResearchComputing/Workshop-IntroToHPC-Slurm/edit/main/README.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/WEHI-ResearchComputing/Workshop-IntroToHPC-Slurm/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/WEHI-ResearchComputing/Workshop-IntroToHPC-Slurm/" class="external-link">Source</a></p>
				<p><a href="https://github.com/WEHI-ResearchComputing/Workshop-IntroToHPC-Slurm/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:iskander.j@wehi.edu.au">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.6" class="external-link">sandpaper (0.16.6)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.6" class="external-link">pegboard (0.7.6)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.4" class="external-link">varnish (1.0.4)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://WEHI-ResearchComputing.github.io/Workshop-IntroToHPC-Slurm/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "hpc, cluster, scheduling, batch, SLURM, parallel, lesson, The Carpentries",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://WEHI-ResearchComputing.github.io/Workshop-IntroToHPC-Slurm/aio.html",
  "identifier": "https://WEHI-ResearchComputing.github.io/Workshop-IntroToHPC-Slurm/aio.html",
  "dateCreated": "2024-08-06",
  "dateModified": "2024-08-27",
  "datePublished": "2024-08-27"
}

  </script><script>
		feather.replace();
	</script>
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

